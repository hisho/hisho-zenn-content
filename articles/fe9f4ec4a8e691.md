---
title: "Next.jsã®Layouts"
emoji: "ğŸ¤"
type: "tech"
topics: ["nextjs","react","typescript"]
published: false
---
Next.jsã®Layoutã«ã¤ã„ã¦TypeScriptã®è¨˜äº‹ã‚’æ¢ã—ã¦ã‚‚ã‚ã¾ã‚Šè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã¾ã¨ã‚ã‚‹
https://nextjs.org/docs/basic-features/layouts

ãƒšãƒ¼ã‚¸ã‚’æ¨ªæ–­ã™ã‚‹å…±é€šã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ¶å¾¡ã™ã‚‹æ©Ÿèƒ½ğŸ˜
ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çŠ¶æ…‹ï¼ˆå…¥åŠ›å€¤ãªã©ï¼‰ã‚‚ä¿æŒã•ã‚Œã‚‹ğŸ¤

## å…±é€šã®components
```tsx:components/Header/Header.tsx
import { memo } from 'react'

let render = 0

export const Header = memo(() => {
  console.log(`render${render}`)
  render++
  return <header>header</header>
})
```
```tsx:components/Footer/Footer.tsx
import { memo } from 'react'

export const Footer = memo(() => <footer>footer</footer>)
```
```tsx:layout/Layout.tsx
import { ReactElement } from 'react'
import { Footer, Header } from '@src/component/ui'

type LayoutProps = Required<{
  readonly children: ReactElement
}>

export const Layout = ({ children }: LayoutProps) => (
  <>
    <Header />
    {children}
    <Footer />
  </>
)
```

## _app.tsxã«ç›´æ¥æ›¸ããƒ‘ã‚¿ãƒ¼ãƒ³
```tsx:pages/_app.tsx
import type { AppProps } from 'next/app'
import { Layout } from '@src/layouts'

function MyApp({ Component, pageProps }: AppProps) {
  return (
    <Layout>
      <Component {...pageProps} />
    </Layout>
  )
}

export default MyApp
```

#### ãƒ¡ãƒªãƒƒãƒˆ
- _app.tsxã«æ›¸ãã ã‘ã§æ¸ˆã‚€

#### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
- å…±é€šã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä»¥å¤–ãŒå‡ºã¦ããŸæ™‚ã«æˆç«‹ã—ãªã„

çµ¶å¯¾å…±é€šã®Layoutã«ãªã‚‹ã¨ã¯é™ã‚‰ãªã„ã—ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã®æ–¹ãŒå¤§ãã„ã®ã§ã€Next.jsã®Layoutsã‚’ä½¿ã„ãƒšãƒ¼ã‚¸å˜ä½ã§å…±é€šã™ã‚‹Layoutã‚’å®šç¾©ã—ãŸæ–¹ãŒè‰¯ã„â˜ºï¸

## nextã®å‹ã‚’æ‹¡å¼µã™ã‚‹
å‹ã¯å…¬å¼ã‹ã‚‰å¼•ç”¨
https://nextjs.org/docs/basic-features/layouts#with-typescript
```ts:types/index.d.ts
import type { NextPage, NextPageWithLayout } from 'next'
import type { AppProps } from 'next/app'
import type { ReactElement } from 'react'

declare module 'next' {
  type NextPageWithLayout<P = {}, IP = P> = NextPage<P, IP> & {
    getLayout?: (page: ReactElement) => ReactElement
  }
}

declare module 'next/app' {
  type AppPropsWithLayout<P = {}> = AppProps<P> & {
    Component: NextPageWithLayout<P>
  }
}
```
## _app.tsxã«getLayoutã‚’è¿½è¨˜ã™ã‚‹
Component.getLayoutãŒãªã„å ´åˆã¯ãã®ã¾ã¾pageã‚’è¿”ã™
```diff tsx:pages/_app.tsx
-import type { AppProps } from 'next/app'
+import type { AppPropsWithLayout } from 'next/app'
-import { Layout } from '@src/layouts'

-function MyApp({ Component, pageProps }: AppProps) {
+function MyApp({ Component, pageProps }: AppPropsWithLayout) {
+  const getLayout = Component.getLayout ?? ((page) => page)
-  return (
-    <Layout>
-      <Component {...pageProps} />
-    </Layout>
-  )
+  return getLayout(<Component {...pageProps} />)
}

export default MyApp
```

## å…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å„ãƒšãƒ¼ã‚¸ã§å‘¼ã³å‡ºã™
### pages/index.tsxã«getLayoutã‚’è¿½è¨˜ã™ã‚‹
```diff tsx:pages/index.tsx
-import type { NextPage } from 'next'
+import type { NextPageWithLayout } from 'next'
import { HomePage } from '@src/component/pages/Home'
+import { Layout } from '@src/layouts'

-const Home: NextPage = () => <HomePage />
+const Home: NextPageWithLayout = () => <HomePage />

+Home.getLayout = (page) => <Layout>{page}</Layout>

export default Home
```

### pages/about/index.tsxã«getLayoutã‚’è¿½è¨˜ã™ã‚‹
```diff tsx:pages/about/index.tsx
-import type { NextPage } from 'next'
+import type { NextPageWithLayout } from 'next'
import { AboutPage } from '@src/component/pages/About'
+import { Layout } from '@src/layouts'

-const About: NextPage = () => <AboutPage />
+const About: NextPageWithLayout = () => <AboutPage />

+About.getLayout = (page) => <Layout>{page}</Layout>

export default About
```

## åˆ¥ã®Layoutã‚’é©å¿œã—ãŸã„æ™‚

```tsx:pages/work/index.tsx
import type { NextPageWithLayout } from 'next'
import { WorkPage } from '@src/component/pages/Work'

const Work: NextPageWithLayout = () => <WorkPage />

Work.getLayout = (page) => (
  <>
    <header>work header</header>
    {page}
    <footer>work footer</footer>
  </>
)

export default Work
```

## ãƒªãƒã‚¸ãƒˆãƒª
https://github.com/hisho/next-layout